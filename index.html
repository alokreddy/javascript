<!DOCTYPE HTML>

<html lang = "en">
	<head>
		<title>Sales Dashboard</title>
		<meta charset = 'utf-8'>
		
		<link type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/dc/2.1.4/dc.min.css" rel="stylesheet"/>
		<link type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" rel="stylesheet">
		<link type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.13/css/jquery.dataTables.min.css" rel="stylesheet">
		<link type="text/css" src="https://cdn.datatables.net/buttons/1.2.4/css/buttons.dataTables.min.css" rel="stylesheet">

		<style>
		
		.col-lg-3{
					margin-right: 5px;  
				}
						
		</style>
	
	</head>

	<body>
		<div class = "container" id = 'main-container' style = "float:left;">
			<div class = "container" >
				<div class = "row">
					<div class = "col" id = 'barProvinceChart' >
					<h3>Province
						<a class ="reset"
							href="javascript:barProvinceChart.filterAll(); dc.redrawAll();"
							style = "display: none;">
						reset</a></h3>		
					</div>
				</div>
			</div>

			<div class = "container-fluid" style = "float:center;">
				<div class = "row align-items-start">
					<div class = "col-sm-3" id = 'pieOrderPriorityChart' >
						<h3>Order Priority<a class ="reset"
							href="javascript:pieOrderPriorityChart.filterAll(); dc.redrawAll();"
							style = "display: none;">
						reset</a></h3>		
					</div>
					<div class = "col-sm-3" id = 'pieCustomerSegmentChart' >
						<h3>Customer Segment<a class ="reset"
							href="javascript:pieCustomerSegmentChart.filterAll(); dc.redrawAll();"
							style = "display: none;">
						reset</a></h3>		
					</div>
					<div class = "col-sm-3" id = 'pieProductCategoryChart' >
						<h3>Product Category<a class ="reset"
							href="javascript:pieProductCategoryChart.filterAll(); dc.redrawAll();"
							style = "display: none;">
						reset</a></h3>		
					</div>
					<div class = "col-sm-3" id = 'pieShipModeChart' >
						<h3>Ship Mode<a class ="reset"
							href="javascript:pieShipModeChart.filterAll(); dc.redrawAll();"
							style = "display: none;">
						reset</a></h3>		
					</div>
				</div>
			</div>


		</div>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/crossfilter/1.3.12/crossfilter.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/dc/2.1.3/dc.js"></script>
<script type="text/javascript" src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script>

<script type="text/javascript">


var timeFormat = d3.time.format('%Y-%m-%d');

d3.csv('data.csv', function(error, data){	
			if(error) throw error;
			 console.log(data[0]);
			 
			 data.forEach(function(x){
				x['Order_Date'] = timeFormat.parse(x['Order_Date']);
				x['Ship_Date'] = timeFormat.parse(x['Ship_Date']);
			 })
//Charts
	barProvinceChart = dc.barChart("#barProvinceChart");
	pieOrderPriorityChart = dc.pieChart("#pieOrderPriorityChart");
	pieCustomerSegmentChart = dc.pieChart("#pieCustomerSegmentChart");
	pieProductCategoryChart = dc.pieChart("#pieProductCategoryChart");
	pieShipModeChart = dc.pieChart("#pieShipModeChart");

var xf = crossfilter(data);

var provinceDim = xf.dimension(function(d) {return d['Province'];}),
	orderPriorityDim = xf.dimension(function(d) {return d['Order_Priority'];}),
	customerSegmentDim = xf.dimension(function(d) {return d['Customer_Segment'];}),
	productCategoryDim = xf.dimension(function(d) {return d['Product_Category'];}),
	shipModeDim = xf.dimension(function(d) {return d['Ship_Mode'];});

//Country Bar Chart
barProvinceChart
	.width(1440)
	.height(480)
	.margins({top: 20, right: 10, bottom: 130, left: 90})
	.x(d3.scale.ordinal())
	.xUnits(dc.units.ordinal)
	.elasticX(true)
	.elasticY(true)
	.colors('#FFD700')
	.brushOn(true)
//	.xAxisLabel('Career Level')
//	.yAxisLabel('Emp Count')
	.dimension(provinceDim)
	.group(provinceDim.group());
	/*.renderlet(function(chart) {
          // rotate x-axis labels
          chart.selectAll('g.x text')
          .attr('transform', 'translate(-1,90) rotate(270)');
        });*/

var pieSize = 256;
		
//Order Priority Pie Chart
pieOrderPriorityChart
	.width(pieSize)
	.height(pieSize)
    .slicesCap(7)
    .innerRadius(80)
    .dimension(orderPriorityDim)
    .group(orderPriorityDim.group())
//    .legend(dc.legend().x(400).y(0).gap(5))
	.renderLabel(true);
/*	.on('pretransition', function(chart) {
        chart.selectAll('text.pie-slice').text(function(d) {
            return [dc.utils.printSingleValue((d.endAngle - d.startAngle) / (2*Math.PI) * 100) + '%'].join('\r\n');
        })
    });*/

//Customer Segment Pie Chart
pieCustomerSegmentChart
	.width(pieSize)
	.height(pieSize)
    .slicesCap(8)
    .innerRadius(80)
    .dimension(customerSegmentDim)
    .group(customerSegmentDim.group())
//    .legend(dc.legend().x(400).y(0).gap(5))
	.renderLabel(true);

//Product Category Pie Chart
pieProductCategoryChart
	.width(pieSize)
	.height(pieSize)
    .slicesCap(8)
    .innerRadius(80)
    .dimension(productCategoryDim)
    .group(productCategoryDim.group())
//    .legend(dc.legend().x(400).y(0).gap(5))
	.renderLabel(true);

//Product Pie Chart
pieShipModeChart
	.width(pieSize)
	.height(pieSize)
    .slicesCap(12)
    .innerRadius(80)
    .dimension(shipModeDim)
    .group(shipModeDim.group())
//    .legend(dc.legend().x(400).y(0).gap(5))
	.renderLabel(true);

	
	//initialize other charts
	dc.renderAll();

	
});
</script>

</body>


</html>
